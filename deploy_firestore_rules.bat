@echo off
chcp 65001 >nul

REM Firebase Firestoreã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆWindowsç‰ˆï¼‰
REM ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€firestore.rulesãƒ•ã‚¡ã‚¤ãƒ«ã‚’Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™

echo ğŸ”¥ Firebase Firestoreã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­...

REM Firebase CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
firebase --version >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ Firebase CLIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
    echo ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼š
    echo npm install -g firebase-tools
    pause
    exit /b 1
)

REM firestore.rulesãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
if not exist "firestore.rules" (
    echo âŒ firestore.rulesãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚
    pause
    exit /b 1
)

REM Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³
echo ğŸ” Firebaseã«ãƒ­ã‚°ã‚¤ãƒ³ä¸­...
firebase login

REM ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
echo ğŸ“¤ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­...
firebase deploy --only firestore:rules

if %errorlevel% equ 0 (
    echo âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã—ã¾ã—ãŸï¼
    echo ğŸ”’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒä¿è­·ã•ã‚Œã¾ã—ãŸã€‚
) else (
    echo âŒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚
    pause
    exit /b 1
)

pause
